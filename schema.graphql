type NftContract @entity {
  id: ID!

  # NEP-177
  spec: String!
  name: String!
  symbol: String!
  icon: String
  base_uri: String
  reference: String
  packages_script: String
  render_script: String
  style_css: String
  parameters: String

  # Stats
  total_supply: BigInt!

  # Relationships
  nfts: [Nft!]! @derivedFrom(field: "contract")
}

type Nft @entity {
  id: ID!

  # Metadata
  title: String
  description: String
  media: String!
  copies: BigInt
  extra: String
  reference: String

  # Ownership
  owner: Account!
  creator: Account!
  prev_owner: Account

  # Relationships
  contract: NftContract!
  history: [Activity!]! @derivedFrom(field: "nft")

  # Market
  ## royalties
  royalties: [Account!]
  royalties_percentage: Int

  ## ask
  askedPrice: Int

  ## shares
  owner_share: Int
  creator_share: Int
  prev_owner_share: Int

  ## bids
  bids: [Bid!] @derivedFrom(field: "nft")
}

type Account @entity {
  id: ID!

  # Stats
  total_supply: BigInt!

  # Relationships
  ownedNfts: [Nft!] @derivedFrom(field: "owner")
  createdNfts: [Nft!] @derivedFrom(field: "creator")
  bids: [Bids!] @derivedFrom(field: "bidder")
}

type Activity @entity {
  id: ID!
  nft: Nft!
  type: ActivityType!
  timestamp: BigInt!

  # mint activity
  mintBy: Account

  # burn activity
  burnBy: Account

  # transfer activity
  transferFrom: Account
  transferTo: Account

  transactionHash: String!
}

enum ActivityType @entity {
  mint
  burn
  transfer
}

type Bid @entity {
  id: ID!
  nft: Nft!
  bidder: Account!

  amount: Int!
  sell_on_share: String
  currency: String

  accepted: boolean
}
